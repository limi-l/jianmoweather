plugins {
    id("com.android.application")
    id("kotlin-android")
    id("kotlin-kapt")
    id("dagger.hilt.android.plugin")
    id("com.google.devtools.ksp").version("$ksp_version")
}

def keystorePropertiesFile = rootProject.file("keystore/keystore.properties")
def keystoreProperties = new Properties()
keystoreProperties.load(new FileInputStream(keystorePropertiesFile))

android {
    compileSdkVersion Versions.COMPILE

    defaultConfig {
        applicationId "com.moshuanghua.jianmoweather"
        minSdkVersion Versions.MIN
        targetSdkVersion Versions.TARGET
        versionCode 1
        versionName "1.0"
        testInstrumentationRunner "androidx.activity_test.runner.AndroidJUnitRunner"
    }

    packagingOptions {
        // Exclude AndroidX version files
        exclude 'META-INF/*.version'
        // Exclude consumer proguard files
        exclude 'META-INF/proguard/*'
        // Exclude the other random properties files
        exclude '/*.properties'
        exclude 'META-INF/*.properties'
    }

    signingConfigs {
        release {
            storeFile rootProject.file("keystore/shuanghua.jks")
            keyAlias keystoreProperties['keyAlias']
            keyPassword keystoreProperties['keyPassword']
            storePassword keystoreProperties['storePassword']
        }

        debug {
            storeFile rootProject.file("debug.keystore")
            storePassword "android"
            keyAlias "androiddebugkey"
            keyPassword "android"
        }
    }

    buildTypes {
        debug {
            signingConfig signingConfigs.release
        }
        release {
            signingConfig signingConfigs.release
            minifyEnabled false
//            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }

    lintOptions {
        abortOnError false
        checkGeneratedSources = true
        checkReleaseBuilds false
    }

    buildFeatures {
        compose true
    }

    composeOptions {
        kotlinCompilerExtensionVersion Versions.compose
    }

    packagingOptions {
        resources {
            excludes += '/META-INF/{AL2.0,LGPL2.1}'
        }
    }

    kapt {
        correctErrorTypes = true
    }
}


dependencies {
    implementation project(':shared')
    implementation project(':model')
    implementation project(':ui-weather')
    implementation project(':ui-favorites')
    implementation project(':ui-more')
    implementation project(':ui-province')
    implementation project(':ui-city')
    implementation project(':data-android')
    implementation project(':common-ui-compose')
    testImplementation Libs.junitExt


    // Activity
    implementation Libs.compose_activity
    implementation Libs.compose_activity_ktx


    // Androidx
    implementation Libs.material // style.xml 主题需要
    implementation Libs.appcompat// WebActivity:AppCompatActivity


    // Coroutines
    implementation Libs.kotlin_coroutines_core
    implementation Libs.kotlin_coroutines_android
    implementation Libs.viewmodel_scope //viewModelScope.launch{}


    // Compose
    implementation Libs.compose_ui
    implementation Libs.compose_ui_tooling
    implementation Libs.compose_layout
    implementation Libs.compose_material3
    implementation Libs.compose_systembar_controller
    implementation Libs.compose_flowlayouts
    implementation Libs.compose_navigation_animation
    implementation Libs.compose_permissions


    // Room
    implementation Libs.room_runtime
    implementation Libs.room_ktx
    ksp Libs.room_compiler


    // Inject
    implementation Libs.hilt_android
    implementation Libs.hilt_compose_navigation_viewmodel
    kapt Libs.hilt_compiler


    // NetWork
    implementation Libs.retrofit
    implementation Libs.retrofit_converter_moshi


    // JsonParse
    implementation Libs.moshi
    ksp Libs.moshi_codegen
    kspTest Libs.moshi_codegen


    // 图片加载库
    implementation Libs.coil
    implementation Libs.coil_compose


    // 日志
    implementation Libs.timber


    // 定位
    implementation Libs.gaode_location


    // 内存泄漏检测
    debugImplementation Libs.leakcanary_android
    // okhttp 日志拦截器
    implementation Libs.okhttp_logging
}
